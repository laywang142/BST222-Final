---
title: "BST 222 : Final Project EDA"
author: "Laura Wang"
output: 
  pdf_document:
header-includes:
  - \newcommand{\gt}{>} 
  - \newcommand{\lt}{<}
  - \usepackage{enumitem}
  - \usepackage{float}
  - \usepackage{geometry}
  - \floatplacement{figure}{H}
urlcolor: blue
classoption: onecolumn
geometry: "left=3cm,right=3cm,top=2cm,bottom=2cm"
---

```{r include=FALSE}
knitr::opts_chunk$set(warning = FALSE, echo = FALSE, message = FALSE)
library(dplyr)
library(kableExtra)
library(knitr)
library(KMsurv)
library(survival)
library(ggplot2)
library(survminer)
library(muhaz)
library(cowplot)
library(gtsummary)
library(flextable)
```

```{r}
#add data
data('bfeed')
bfeed1 <- bfeed %>% 
  mutate(race = case_when(race == 1 ~ "white",
                          race == 2 ~ "black", 
                          race == 3 ~ "other") %>% 
           factor(levels = c("white", "black", "other"), ordered = T),
         delta = factor(delta),
         poverty = factor(poverty, levels = c(1,0), labels = c("yes", "no")),
         smoke = factor(smoke, levels = c(1,0), labels = c("yes", "no")),
         alcohol = factor(alcohol, levels = c(1,0), labels = c("yes", "no")),
         pc3mth = factor(pc3mth, levels = c(1,0), labels = c("yes", "no")),
         yschool = case_when(yschool < 12 ~ "noHS",
                             yschool == 12 ~ "HSgrad", 
                             yschool > 12 ~ "someCollege") %>% 
           factor(levels = c("noHS", "HSgrad", "someCollege"), ordered = T)
         )

str(bfeed1)

#define survival
survival <- Surv(time = bfeed$duration, event = bfeed1$delta)
```

```{r}
bfeed1 %>% 
  tbl_summary(include = c(race, yschool, poverty, alcohol, smoke, pc3mth)) %>% 
  modify_header(label = "**bfeed Summary**") %>% 
  #modify_caption("\\label{tab:tab2}Summary of Data by Treatment Type") %>% 
  as_kable_extra(format = "latex", booktabs = T,
                 caption = "\\label{tab:tab2}Summary of Data by Outcome") %>% 
  kable_styling(latex_options = c("striped", "HOLD_position"), 
                    full_width = F
                    )
```

```{r}
#base KM curve
KMcurves <- survfit(survival ~ 1, data = bfeed1)

#plot KM curve
plot(KMcurves, lwd=1, xlab = "Time (weeks)", ylab = "Survival", conf.int = F)
title("KM Survival Curves for breastfeeding")
```

