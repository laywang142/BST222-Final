# Exploratory Data Analysis  



```{r bfeeddens, fig.cap="Density Plot of Breastfeeding Duration", fig.height=3.5, message=FALSE, warning=FALSE, fig.align='center'}
plot(density(df$duration, na.rm = TRUE), main="Density Plot of Breastfeeding Duration", xlab="Duration (weeks)", ylab="Density", col="green", lwd=2)
```

Figure \@ref(fig:bfeeddens) is a density plot shows that almost all of the mothers in the study only breastfeed for no more than about 50 weeks, which is about a year. On the graph there is a spike at around 10-12 weeks indicating that the majority of mothers only breastfeed for about a few months.



```{r mthage, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Density Plots Mother's Age by Race"}


plot(density(bfeed$agemth[bfeed$race == 1], na.rm = TRUE), main="Density Plot of Mother's Age by Race", xlab="Mother's Age", ylab="Density", col="lightblue", lwd=2)
lines(density(bfeed$agemth[bfeed$race == 2], na.rm = TRUE), col="salmon", lwd=2)
lines(density(bfeed$agemth[bfeed$race == 3], na.rm = TRUE), col="lightgreen", lwd=2)
legend("topright", legend=c("White", "Black", "Other"), col=c("lightblue", "salmon", "lightgreen"), lwd=2)

```

Figure \@ref(fig:mthage) shows the density of the mothers' age by race demonstrates that black mothers and mothers of other races tend to have their first kids younger than white mothers.


```{r edubar, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Bar Plot on Education proportion By Breastfeeding Status"}
# barplot
barplot(prop.table(table(df$yschool, df$delta), 2), 
        #main="Education Level Distribution within Breastfeeding Completion Status", 
        xlab="Breastfeeding Completion", 
        ylab="Proportion", 
        col=c("lightblue", "salmon", "lightgreen"),
        names.arg=c("Not Weaned", "Weaned"),
        beside=TRUE
    )
legend("topright", 
  legend = c( "No High School", "HS Grad", "Some College"), 
  fill = c("lightblue", "salmon", "lightgreen"), 
  ncol = 2, 
  bty = "n", 
  cex = 0.75)
```

Figure \@ref(fig:edubar) compares the group of mothers who weaned their babies versus those who did not wean their babies. Those who didnn't wean their children had higher proportion of mothers who went some college in their education background. Mothers who weaned their babies had a higher proportion of those who did not finish high school. 

```{r catvarbox, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Box Plot for Categorical Variables"}
par(mfrow=c(1,2)) 



# Boxplot for Breastfeeding Duration by Poverty
boxplot(df$duration ~ df$poverty, 
        main="Breastfeeding Duration by Poverty", 
        ylab="Duration (weeks)", 
        xlab="Poverty", 
        col=c("lightblue", "salmon"),
        names=c("In Poverty", "Not in Poverty"), 
        cex.main=0.9) # 

# Boxplot for Breastfeeding Duration by Smoking
boxplot(df$duration ~ df$smoke, 
        main="Breastfeeding Duration by Smoking", 
        ylab="Duration (weeks)", 
        xlab="Smoke", 
        col=c("lightgreen", "yellow"),
        names=c("Smoker", "Non-Smoker"),
        cex.main=0.9) #
```


```{r catvarbox2, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Box Plot for Categorical Variables"}
par(mfrow=c(1,2)) 
# Boxplot for Breastfeeding Duration by Alcohol Use
boxplot(df$duration ~ df$alcohol, 
        main="Breastfeeding Duration by Alcohol Use", 
        ylab="Duration (weeks)", 
        xlab="Alcohol", 
        col=c("pink", "gray"),
        names=c("Alcohol Use", "No Alcohol"),
        cex.main=0.9) # 

# Boxplot for Breastfeeding Duration by Prenatal Care
boxplot(df$duration ~ df$pc3mth, 
        main="Breastfeeding Duration by Prenatal Care", 
        ylab="Duration (weeks)", 
        xlab="Prenatal Care after 3rd Month", 
        col=c("orange", "purple"),
        names=c("Prenatal Care", "No Prenatal Care"),

        cex.main=0.9, cex.axis=.8) # 


```


In figure Figure \@ref(fig:catvarbox), the  first box plot shows that the breastfeeding duration for those in poverty compared to those who are not in poverty are similar but those in poverty have a slightly lower and narrower breastfeeding duration range. The second box plot shows that mothers who smoked had a sligtly shorter breastfeeding duration and that the range for breastfeeding duration is also narrower compared to mothers who did not smoke.

In figure \@ref(fig:catvarbox2), the first box plot, demonstrates that mothers who use alcohol have a narrower breastfeeding distribution with most mothers breastfeeding betwween 0 and under 50 weeks. Mothers who did not consume alcohol tend to breastfeed between 0 and 52 weeks. Those mothers who consumed alcohol tend breastfeed for a shorter amount of time compared to those who did not.
The second box plot showed that the breastfeeding duration distribution of mothers who had prenatal care compared to those are very similar, with majority of both groups mainly brestfeeding  for 0 weeks to 50 weeks.




```{r boxbfeedstat, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Box Plot of Race Distribution by Breastfeeding Status"}
barplot(prop.table(table(df$race, df$delta), 2), 
        main="Race Distribution within Breastfeeding Completion Status", 
        xlab="Breastfeeding Completion", 
        ylab="Proportion", 
        col=c("lightblue", "salmon", "lightgreen"), 
        names.arg=c("Not Weaned", "Weaned"),
        cex.main=0.9,
        beside=FALSE)

legend("bottomright", 
  legend =c("White", "Black", "Other"),
  fill = c("lightblue", "salmon", "lightgreen"),
  bg="white",
  ncol = 1, 
  bty = "o", 
  cex = 0.75)
```
Figure \@ref(fig:boxbfeedstat) compares the proportion of each race by breastfeeding status. The group of mothers who were able to wean have a high proportion of mothers of other race and black mothers compared to the group that did not wean.


```{r kmrace, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="KM Curve - Race"}

# check for stratification in race
KMcurves_race <- survfit(surv ~ race, data = df)
plot(KMcurves_race, col = 1:3, main = "KM Curves for Races", ylab = "Probability", xlab = "Time (weeks)")
legend("topright", legend = c("White", "Black", "Other"), col = 1:3, lty = 1)

#survdiff(surv ~ race, data = df) #different processes
```

Figure \@ref(fig:kmrace) compares the probability a mother doesn't wean for each of the different race categories. For each race, there is a steep decline around the 10-20 week mark indicating many mothers stop breastfeeding around that time. Additionally, mothers of other race tend to wean sooner then black mothers and white mothers. Black mothers also weaned faster than white mothers.


```{r kmpoverty, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="KM Curve - Poverty"}
KMcurves_poverty <- survfit(surv ~ poverty, data = df)
plot(KMcurves_poverty, col = 1:2, main = "KM Curves for Poverty", ylab = "Probability", xlab = "Time (weeks)")
legend("topright", legend = c("Yes", "No"), col = 1:2, lty = 1)

#survdiff(surv ~ poverty, data = df) #no difference
```

Figure \@ref(fig:kmpoverty) compares the probability a mother doesn't wean depending if they are in poverty or not. For both groups, there is a steep decline around the 10-20 week mark indicating many mothers stop breastfeeding around that time. The Kaplen Meier curves are similar and do overlap til around week 30 where it can be seen that mother's who are not in poverty have a higher probability of weaning their child.

```{r kmsmoke, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="KM Curve - Smoke"}
KMcurves_smoke <- survfit(surv ~ smoke, data = df)
plot(KMcurves_smoke, col = 1:2, main = "KM Curves for Smoke" , ylab = "Probability", xlab = "Time (weeks)")
legend("topright", legend = c("Yes", "No"), col = 1:2, lty = 1)

#survdiff(surv ~ smoke, data = df) #different processes
```

Figure \@ref(fig:kmsmoke), compares the probability a mother does not wean for mothers who smoke and mothers who do not smoke. The curves have a steep decline around the 10-20 week mark indicating that many mothers stop breastfeeding around that time period. The Kaplen Meier curves indicate that there is a higher probability that mothers who smoke will wean compare to those who do not smoke.


```{r kmschool, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="KM Curve - Education"}
KMcurves_yschool <- survfit(surv ~ yschool, data = df)
plot(KMcurves_yschool, col = 1:3, main = "KM Curves for Education" ,ylab = "Probability", xlab = "Time (weeks)")
legend("topright", legend = c("noHS", "HSgrad", "comeCollege"), col = 1:3, lty = 1)

#survdiff(surv ~ yschool, data = df) #some difference
```
Figure \@ref(fig:kmschool), compares the probability a mother does not wean for mothers in different education levels. The curves have a steep decline around the 10-20 week mark indicating that there is a low probability that mothers continue breastfeeding around that time period. Mothers with some college education are more likely to not wean compare to mothers with high school education and mothers with no high school education. For the KM curves for mothers with no high school education and those with only a high school degree have similar likelihoods of not weaning their child till around week 20. Around that time those without a high school education are more likely to wean than those without one.

```{r sect1, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Density Plots for Sepal.Length"}
```


```{r sect2, fig.align='center', fig.height=3.5, message=FALSE, warning=FALSE, fig.cap="Density Plots for Sepal.Length"}
```

